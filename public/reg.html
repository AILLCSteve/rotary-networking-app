<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rotary Networking - Register</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ù Rotary Business Networking</h1>
            <p class="subtitle">AI-Powered Connection Matching</p>
        </div>

        <div class="card" id="registerCard">
            <h2>Register for Smart Networking</h2>
            <p class="info">Fill out your profile to get matched with complementary businesses</p>
            
            <form id="registerForm">
                <div class="form-section">
                    <h3>Basic Information</h3>
                    
                    <div class="form-group">
                        <label for="name">Your Name *</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="org">Organization *</label>
                        <input type="text" id="org" name="org" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="role">Your Role *</label>
                        <input type="text" id="role" name="role" placeholder="e.g., CEO, Sales Director, Owner" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="industry">Industry *</label>
                        <input type="text" id="industry" name="industry" placeholder="e.g., Healthcare, Manufacturing, Tech" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="city">City *</label>
                        <input type="text" id="city" name="city" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="email">Email (optional - for backup access)</label>
                        <input type="email" id="email" name="email">
                    </div>
                </div>
                
                <div class="form-section">
                    <h3>Business Profile</h3>
                    
                    <div class="form-group">
                        <label for="rev_driver">What drives your revenue?</label>
                        <textarea id="rev_driver" name="rev_driver" rows="2" placeholder="e.g., B2B software sales, retail foot traffic, subscription services"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="current_constraint">Current biggest constraint/challenge?</label>
                        <textarea id="current_constraint" name="current_constraint" rows="2" placeholder="e.g., Lead generation, talent acquisition, supply chain"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="assets">What assets/strengths do you have? (comma-separated)</label>
                        <textarea id="assets" name="assets" rows="2" placeholder="e.g., large email list, event space, technical expertise, strong brand"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="needs">What do you need help with? (comma-separated)</label>
                        <textarea id="needs" name="needs" rows="2" placeholder="e.g., marketing, distribution, funding, partnerships"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="fun_fact">Fun fact about you or your business</label>
                        <input type="text" id="fun_fact" name="fun_fact" placeholder="e.g., We have a office dog named Revenue">
                    </div>
                </div>
                
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="consent" name="consent" checked required>
                        I agree to participate in the networking matching system
                    </label>
                </div>
                
                <button type="submit" class="btn btn-primary">Register & See My Matches</button>
            </form>
        </div>

        <div class="card hidden" id="successCard">
            <div class="success-message">
                <h2>‚úÖ Registration Complete!</h2>
                <p>Your profile has been created successfully.</p>
                <p class="member-id-display">Your Member ID: <span id="memberIdDisplay"></span></p>
                <p class="info">Save this link to access your matches:</p>
                <div class="link-box" id="linkBox"></div>
                <button class="btn btn-primary" id="goToMatches">View My Matches</button>
            </div>
        </div>
    </div>

    <script>
        const form = document.getElementById('registerForm');
        const registerCard = document.getElementById('registerCard');
        const successCard = document.getElementById('successCard');
        
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(form);
            const data = Object.fromEntries(formData);
            data.consent = document.getElementById('consent').checked;
            
            try {
                const response = await fetch('/api/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    const matchesUrl = `${window.location.origin}/matches.html?id=${result.memberId}`;
                    
                    document.getElementById('memberIdDisplay').textContent = result.memberId;
                    document.getElementById('linkBox').innerHTML = `<a href="${matchesUrl}">${matchesUrl}</a>`;
                    
                    registerCard.classList.add('hidden');
                    successCard.classList.remove('hidden');
                    
                    document.getElementById('goToMatches').onclick = () => {
                        window.location.href = matchesUrl;
                    };
                    
                    // Auto-redirect after 5 seconds
                    setTimeout(() => {
                        window.location.href = matchesUrl;
                    }, 5000);
                }
            } catch (error) {
                alert('Registration failed. Please try again.');
                console.error(error);
            }
        });
    </script>
</body>
</html>
